<div class="page-container">
    <div class="list-container">
      <div class="list-header">
        <div class="header-info">
          <h2>All Assets ({{ filteredAssets.length }})</h2>
          <div class="stats">
            <span class="stat-badge available">Available: {{ availableCount }}</span>
            <span class="stat-badge deployed">Deployed: {{ deployedCount }}</span>
          </div>
        </div>
  
        <div class="header-actions">
          <div class="search-box">
            <input 
              type="text" 
              [(ngModel)]="searchTerm"
              (keyup.enter)="onSearch()"
              placeholder="Search assets..."
              class="search-input">
            <button class="btn-search" (click)="onSearch()">üîç</button>
          </div>
  
          <select [(ngModel)]="selectedStatus" (change)="onFilterChange()" class="filter-select">
            <option value="">All Statuses</option>
            <option *ngFor="let status of statuses" [value]="status.id">{{ status.name }}</option>
          </select>
  
          <select [(ngModel)]="selectedLocation" (change)="onFilterChange()" class="filter-select">
            <option value="">All Locations</option>
            <option *ngFor="let location of locations" [value]="location.id">{{ location.name }}</option>
          </select>
  
          <button class="btn-clear" (click)="clearFilters()" *ngIf="searchTerm || selectedStatus || selectedLocation">
            Clear Filters
          </button>
  
          <button class="btn-new" routerLink="/assets/new">
            <span class="btn-icon">+</span>
            New
          </button>
        </div>
      </div>
  
      <div class="loading-spinner" *ngIf="isLoading">
        <div class="spinner"></div>
        <p>Loading assets...</p>
      </div>
  
      <div class="table-container" *ngIf="!isLoading">
        <table class="assets-table">
          <thead>
            <tr>
              <th>IMAGE</th>
              <th>ID</th>
              <th>PRODUCT</th>
              <th>STATUS</th>
              <th>CHECKOUT/IN</th>
              <th>ASSET NAME</th>
              <th>SERIAL</th>
              <th>WARRANTY</th>
              <th>END OF LIFE</th>
              <th>ORDER NUMBER</th>
              <th>ACTIONS</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let asset of filteredAssets" 
                class="asset-row"
                [routerLink]="['/assets', asset.id]">
              <td>
                <img [src]="getImageUrl(asset.image_path)" 
     alt="{{ asset.asset_name }}"
     class="asset-image"
     (error)="$any($event.target).src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2260%22 height=%2260%22%3E%3Crect width=%2260%22 height=%2260%22 fill=%22%23ddd%22/%3E%3Ctext x=%2250%25%22 y=%2250%25%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 font-family=%22sans-serif%22 font-size=%2214%22 fill=%22%23999%22%3ENo Image%3C/text%3E%3C/svg%3E'">
              </td>
              <td class="asset-id">{{ asset.asset_id }}</td>
              <td>{{ asset.product_name || '-' }}</td>
              <td>
                <span class="status-badge" [ngClass]="getStatusClass(asset.status_name || '')">
                  {{ asset.status_name || '-' }}
                </span>
              </td>
              <td>
                <button class="btn-checkout" (click)="$event.stopPropagation()">
                  {{ asset.status_name === 'Deployed' ? '‚Üê' : '‚Üí' }}
                </button>
              </td>
              <td>{{ asset.asset_name || '-' }}</td>
              <td>{{ asset.serial_number || '-' }}</td>
              <td>
                <span [class.expired]="calculateWarrantyStatus(asset.warranty_expiration_date).includes('Expired')">
                  {{ calculateWarrantyStatus(asset.warranty_expiration_date) }}
                </span>
              </td>
              <td>{{ calculateEndOfLife(asset.warranty_expiration_date) }}</td>
              <td>{{ asset.order_number || '-' }}</td>
              <td>
                <div class="action-buttons">
                  <button class="btn-action btn-edit" 
                          (click)="$event.stopPropagation()"
                          [routerLink]="['/assets', asset.id, 'edit']"
                          title="Edit">
                    ‚úèÔ∏è
                  </button>
                  <button class="btn-action btn-delete" 
                          (click)="deleteAsset(asset.id, $event)"
                          title="Delete">
                    üóëÔ∏è
                  </button>
                </div>
              </td>
            </tr>
            <tr *ngIf="filteredAssets.length === 0">
              <td colspan="11" class="no-data">
                <div class="no-data-message">
                  <span class="no-data-icon">üì¶</span>
                  <p>No assets found</p>
                  <button class="btn-add-first" routerLink="/assets/new">Add your first asset</button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>